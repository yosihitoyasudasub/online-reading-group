現在のリファクタリング候補：

  🔴 重要度：高

  1. コードの重複 - getServiceAccountAuth() ⭐最優先

  - api/calendar.js:3-19 と api/reservations.js:3-21 で完全に重複
  - 解決策: 共通モジュール utils/googleAuth.js に抽出

  2. コードの重複 - addReservationToEvent()

  - server.js:56-103 と api/reservations.js:23-73 で重複
  - 解決策: 共通モジュールに抽出、または server.js で
  api/reservations.js の関数を import

  3. server.js の認証方式の混在

  - OAuth2Client (server.js:12-22) が現在未使用
  - ServiceAccount 認証のみ必要
  - 解決策: OAuth2Client を削除し、ServiceAccount に統一

  4. 競合リスク - イベント説明欄の同時更新

  - 複数ユーザーが同時に予約すると、説明欄が上書きされる可能性       
  - 解決策: 楽観的ロック or イベント取得→更新を短時間で実行

  🟡 重要度：中

  5. 不要なコード

  - calendar.js:1-8 - CALENDAR_CONFIG と gapi 変数が未使用
  - calendar.js:16-18, 180-182 - 無意味な環境判定（常に同じURL）     

  6. マジックナンバー

  - calendar.js:306 2000 → COPY_SUCCESS_DURATION
  - api/calendar.js:42 90 * 24 * 60 * 60 * 1000 →
  DAYS_TO_MILLISECONDS(90)

  7. インラインスタイル

  - calendar.js:218 - CSSクラスに移動

  8. CORSヘッダーの重複

  - api/calendar.js と api/reservations.js で重複

  🟢 重要度：低

  9. タイムゾーンのハードコード

  - 'Asia/Tokyo' が複数箇所に散在 → 定数化

  10. 未実装機能

  - script.js:39-45 - アーカイブリンクが単なるアラート

  📋 推奨リファクタリング順序

  1. 共通認証関数の抽出 (1, 2)
  2. server.js の OAuth2Client 削除 (3)
  3. 不要コードの削除 (5)
  4. 定数の定義 (6, 9)
  5. インラインスタイル削除 (7)
  6. 競合対策の検討 (4)

  どの項目から実施しますか？